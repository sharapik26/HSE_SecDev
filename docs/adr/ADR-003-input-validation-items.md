# ADR-003: Строгая валидация входа для /items

Дата: 2025-12-14
Статус: Accepted

## Context
- Нужна защита от некорректных данных на CRUD /items (аналог /wishes) в соответствии с NFR-05 (валидация) и угрозой R4 (Tampering/Injection) на потоке F3.
- Текущая логика принимала строковые параметры без схемы.

## Decision
- Использовать Pydantic-модель `ItemIn` с `name: str` (min_length=1, max_length=100).
- Обрабатывать ошибки Pydantic через общий RFC7807 обработчик (422 validation_error).

## Alternatives
- Ручные if/len проверки — дублирование и неполные сообщения об ошибках.
- Принимать произвольный JSON и валидировать в бизнес-логике — больше кода и риск пропустить поля.

## Consequences
- (+) Единый контракт валидации, автоматические сообщения об ошибках.
- (+) Легко расширять схему без переписывания проверок.
- (−) Жёсткие границы длины могут требовать пересмотра при изменении бизнес-правил.

## Links
- NFR-05; F3; Risk R4.
- Код: `app/main.py` (`ItemIn`, обработчик 422).
- Тест: `tests/test_errors.py::test_validation_error_problem_details`.
